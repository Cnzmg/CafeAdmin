
doctype html
html(lang="en")
  meta(charset="UTF-8")
  meta(name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0")
  meta(http-equiv="X-UA-Compatible" content="ie=edge") 
  meta(http-equiv="Pragma" content="no-cache")
  meta(http-equiv="Cache-control" content="no-cache") 
  meta(http-equiv="Cache" content="no-cache") 
  head
    title 咖速修
    script(src="https://cdn.jsdelivr.net/npm/vue/dist/vue.min.js")
    script(src="https://cdn.jsdelivr.net/npm/vant@2.8/lib/vant.min.js")
    link(rel="stylesheet" href="https://cdn.jsdelivr.net/npm/vant@2.8/lib/index.css")
  body
    .container#app
      van-overlay(:show="loadingShow")
        van-loading(size="24px") 加载中...
      van-skeleton(title :row="20" :loading="show")
        van-swipe(class="my-swipe" :autoplay="3000" indicator-color="white" :show-indicators=false)
          van-swipe-item
              img(:src="detailsImages" style="width: 100%;")
        van-cell-group
          van-cell(class="cell_border" title="工单号" :value="workList.workId")

          van-cell(class="cell_border")
            template(#title)
              div(style="width: 4px;background: red;height: 100%;float: left;margin-right: 6px")
              span(class="custom-title" style="font-weight: blod;") 需求信息
              van-tag(type="success" style="float: right; cursor: pointer; color: #FFF" @click="dobient(); contentMsg = true" v-if="workList.hasBeenModified != 1") 修改报修类型
          van-cell(title="需求名称" :value="workList.demandChargeName")
          van-cell(title="报修类型名称" :value="workList.repairsTypeName")
          van-cell(title="产品名称" :value="workList.facilityName")
          van-cell(title="备注" :value="workList.faultContent")
          van-cell(v-if="workList.video != '无'")
            template(#title)
              span(class="custom-title" style="font-weight: blod;") 视频附件
              video(:src="workList.video" controls="controls" width="200" height="200" style="display: block;")
          van-cell(title="图片" v-if="workList.faultDiagram != '无'"  @click="vant.ImagePreview([workList.faultDiagram])")
            van-image(style="width: 100px;margin-top:2px;" :src="workList.faultDiagram")


          van-cell(class="cell_border")
            template(#title)
              div(style="width: 4px;background: red;height: 100%;float: left;margin-right: 6px")
              span(class="custom-title" style="font-weight: blod;") 门店信息
          van-cell(title="门店名称" :value="workList.shopName")
          van-cell(title="门店地址" :value="workList.province+'/'+workList.city+'/'+workList.district+'/'+workList.address")

          van-cell(class="cell_border")
            template(#title)
              div(style="width: 4px;background: red;height: 100%;float: left;margin-right: 6px")
              span(class="custom-title" style="font-weight: blod;") 联系人信息
          van-cell(title="联系人名称" :value="workList.contactName")
          van-cell(title="联系人电话" :value="workList.contactPhone")
          
          van-cell(class="cell_border")
            template(#title)
              div(style="width: 4px;background: red;height: 100%;float: left;margin-right: 6px")
              span(class="custom-title" style="font-weight: blod;") 师傅信息
          van-cell(title="维修师傅" :value="workList.maintainerName")
          van-cell(title="维修师傅电话" :value="workList.maintainerPhone")
          div(v-if="workList.status == '已派单'" style="text-align: center;")
            van-button(type="info" plain style="width: 50%; margin: 10px auto; font-size: 12px;background: none; border-color: #1989fa;" @click="goToChat") 在线沟通
          
          van-cell(class="cell_border")
            template(#title)
              div(style="width: 4px;background: red;height: 100%;float: left;margin-right: 6px")
              span(class="custom-title" style="font-weight: blod;") 订单信息
          van-cell(:value="workList.parentId" v-if="workList.parentId != '无'")
            template(#title)
              span(class="custom-title") 父级工单号
              van-tag(mark type="success") 二
          van-cell(title="创建时间" :value="workList.createTime")
          van-cell(title="创建类型" :value="workList.creationType")
          van-cell(title="微信昵称" :value="workList.nickName")
          van-cell(title="维修金额" :value="workList.maintainPaymentStr")
          van-cell(title="设备名称" :value="workList.machineName")
          van-cell(title="预支付费用" :value="workList.visitCostStr")
          van-cell(title="配件费用" :value="workList.partPaymentStr")
          van-cell(title="期待上门时间" :value="workList.visitingTime")
          van-cell(title="状态" :value="workList.status")
          div(style="width: 100%;margin-bottom: 20px;height: auto;overflow: hidden;")
            van-button(round type="info" class="btn" @click="href('order')" style="width: 40%; float: left;") 返回上一页
            van-button(round type="info" class="btn" @click="href('logs')" style="width: 40%; float: left;") 查看日志
          van-popup(v-model="contentMsg" position="bottom")
            van-tree-select(:items="items" :active-id.sync="activeId" :main-active-index.sync="activeIndex" @click-item="onSelectDetails")
          
          